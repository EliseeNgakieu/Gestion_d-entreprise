<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion d'Entreprise - Détails de l'employé</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useEffect, useState } = React;

        function Section({ title, icon, children }) {
            return (
                <div className="bg-white/90 backdrop-blur border border-green-100 rounded-2xl shadow-lg p-5 hover:shadow-xl transition-shadow">
                    <div className="flex items-center gap-2 border-b border-green-100 pb-3 mb-4">
                        {icon}
                        <h3 className="text-lg font-semibold text-green-700">{title}</h3>
                    </div>
                    <div className="space-y-2">{children}</div>
                </div>
            );
        }

        function Field({ label, value, isTextarea = false }) {
            const displayValue = (() => {
                if (typeof value === "string") {
                    const trimmed = value.trim();
                    return trimmed.length > 0 ? trimmed : null;
                }
                return value ?? null;
            })();

            return (
                <div>
                    <p className="text-xs uppercase text-green-500 tracking-wide mb-1">{label}</p>
                    {isTextarea ? (
                        <p className="text-sm text-green-900 font-medium whitespace-pre-wrap">
                            {displayValue || "Non renseigné"}
                        </p>
                    ) : (
                        <p className="text-sm text-green-900 font-medium">{displayValue || "Non renseigné"}</p>
                    )}
                </div>
            );
        }

        const sectionIcons = {
            main: (
                <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" strokeWidth="1.8" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M8 7h8m-8 4h6m-8 4h8m1 5H7a2 2 0 01-2-2V6a2 2 0 012-2h5.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
            ),
            contact: (
                <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" strokeWidth="1.8" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-18 8h18a2 2 0 002-2V6a2 2 0 00-2-2H3a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
            ),
            contract: (
                <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" strokeWidth="1.8" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M9 12h6m-6 4h6m-7 4h8a2 2 0 002-2V7.414a2 2 0 00-.586-1.414l-3.414-3.414A2 2 0 0012.586 2H7a2 2 0 00-2 2v16a2 2 0 002 2z" />
                </svg>
            ),
            personal: (
                <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" strokeWidth="1.8" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M12 12a5 5 0 100-10 5 5 0 000 10zm-7 9a7 7 0 0114 0H5z" />
                </svg>
            ),
        };

        function EmployeeDetails() {
            const [employee, setEmployee] = useState(null);

            useEffect(() => {
                try {
                    const params = new URLSearchParams(window.location.search);
                    const employeeId = params.get("id");
                    const stored = JSON.parse(localStorage.getItem("employees") || "[]");
                    const current = stored.find((emp) => String(emp.id) === employeeId);
                    setEmployee(current || null);
                } catch (error) {
                    console.error("Erreur de chargement des détails :", error);
                    setEmployee(null);
                }
            }, []);

            if (!employee) {
                return (
                    <div className="min-h-screen bg-gradient-to-b from-green-50 to-white flex items-center justify-center p-6 text-center text-green-700">
                        <div>
                            <p className="text-lg font-semibold">Aucun employé sélectionné.</p>
                            <button
                                className="mt-4 px-6 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700"
                                onClick={() => (window.location.href = "gestion.html")}
                            >
                                Retour à la liste
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-b from-green-50 via-white to-green-100 py-10 px-4">
                    <div className="max-w-5xl mx-auto space-y-8">
                        <div className="relative flex flex-col md:flex-row items-center md:items-start gap-6 bg-white/95 backdrop-blur border border-green-100 rounded-3xl shadow-2xl p-6 md:p-8 overflow-hidden">
                            <div className="absolute inset-0 bg-gradient-to-r from-green-50 via-transparent to-green-100 opacity-70 pointer-events-none"></div>
                            <div className="relative w-32 h-32 rounded-2xl overflow-hidden border-2 border-green-200 bg-green-50 flex items-center justify-center shadow-lg">
                                {employee.photo ? (
                                    <img src={employee.photo} alt={employee.fullName} className="w-full h-full object-cover" />
                                ) : (
                                    <span className="text-xs text-green-500 text-center px-2">Pas de photo</span>
                                )}
                            </div>
                            <div className="relative flex-1 text-center md:text-left space-y-3">
                                <div className="inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold uppercase tracking-wide">
                                    Profil employé
                                </div>
                                <h1 className="text-3xl md:text-4xl font-bold text-green-900">{employee.fullName}</h1>
                                <p className="text-lg text-green-700 font-medium">{employee.jobTitle || "Poste non renseigné"}</p>
                                <p className="text-sm text-green-500">{employee.department || "Département non renseigné"}</p>
                                <div className="flex flex-wrap gap-3 justify-center md:justify-start mt-3">
                                    {employee.contractType && (
                                        <span className="px-4 py-1.5 rounded-full bg-white/90 border border-green-200 text-xs font-semibold text-green-700">
                                            Contrat : {employee.contractType}
                                        </span>
                                    )}
                                    {employee.startDate && (
                                        <span className="px-4 py-1.5 rounded-full bg-white/90 border border-green-200 text-xs font-semibold text-green-700">
                                            Depuis {employee.startDate}
                                        </span>
                                    )}
                                </div>
                                <div className="mt-4 flex flex-wrap gap-3 justify-center md:justify-start">
                                    <button
                                        className="px-5 py-2 rounded-xl border border-green-600 text-green-700 text-sm font-semibold hover:bg-green-50 transition"
                                        onClick={() => (window.location.href = "gestion.html")}
                                    >
                                        Retour à la liste
                                    </button>
                                    <button
                                        className="px-5 py-2 rounded-xl bg-green-600 text-white text-sm font-semibold hover:bg-green-700 shadow-lg transition"
                                        onClick={() => {
                                            const params = new URLSearchParams(window.location.search);
                                            const employeeId = params.get("id");
                                            window.location.href = `Modifier.html?id=${employeeId}`;
                                        }}
                                    >
                                        Éditer
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <Section title="Informations principales" icon={sectionIcons.main}>
                                <Field label="Nom complet" value={employee.fullName} />
                                <Field label="Titre du poste" value={employee.jobTitle} />
                                <Field label="Département" value={employee.department} />
                                <Field label="Date d'arrivée" value={employee.startDate} />
                            </Section>
                            <Section title="Coordonnées" icon={sectionIcons.contact}>
                                <Field label="Email" value={employee.email} />
                                <Field label="Téléphone" value={employee.contact} />
                                <Field label="Manager direct" value={employee.manager} />
                            </Section>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <Section title="Informations de contrat" icon={sectionIcons.contract}>
                                <Field label="Type de contrat" value={employee.contractType} />
                                <Field label="Durée du contrat" value={employee.contractDuration} />
                                <Field label="Informations administratives" value={employee.adminInfo} isTextarea={true} />
                            </Section>
                            <Section title="Informations personnelles" icon={sectionIcons.personal}>
                                <Field label="Date de naissance" value={employee.birthDate} />
                                <Field label="Lieu de naissance" value={employee.birthPlace} />
                                <Field label="Responsabilités principales" value={employee.responsibilities} isTextarea={true} />
                                <Field label="Compétences spécialisées" value={employee.skills} isTextarea={true} />
                            </Section>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<EmployeeDetails />);
    </script>
</body>
</html>

